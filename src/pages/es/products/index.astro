---
// Importing necessary components
import MainLayout from "@/layouts/MainLayout.astro";
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import CardSmall from "@components/ui/cards/CardSmall.astro";
import CardWide from "@components/ui/cards/CardWide.astro";
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import TestimonialsSectionAlt from "@components/sections/testimonials/TestimonialsSectionAlt.astro";

// Importing necessary functions from Astro
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { SITE } from "@data";

// Fetching all the product related content and sorting it by main.id
const product: CollectionEntry<"products">[] = (
  await getCollection("products", ({ id }) => {
    return id.startsWith("es/");
  })
).sort(
  (a: CollectionEntry<"products">, b: CollectionEntry<"products">) =>
    a.data.main.id - b.data.main.id
);

// Define variables for page content
const title: string = "Productos";
const subTitle: string =
  "Explore nuestra gama de tanques ISO diseñados para profesionales de la industria. Cada uno de nuestros productos está fabricado con precisión y construido para durar, garantizando soluciones confiables para cada necesidad.";

// Testimonial data that will be rendered in the component
const testimonials = [
  {
    content:
      "Desde que comenzamos a trabajar con Tank Global Solutions, la eficiencia en nuestras operaciones logísticas ha mejorado significativamente. La calidad de los tanques ISO y el soporte técnico son incomparables.",
    author: "Carlos Mendoza",
    role: "Director de Operaciones | LogiChem",
    avatarSrc:
      "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Foto de Carlos Mendoza",
  },
  {
    content:
      "Como gerente de planta, siempre busco equipos de alta calidad que garanticen la seguridad de nuestras operaciones. Los tanques criogénicos de Tank Global han sido una excelente inversión para nuestra empresa.",
    author: "María González",
    role: "Gerente de Planta | CryoTech Industries",
    avatarSrc:
      "https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1376&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D8&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Foto de María González",
  },
  {
    content:
      "Llevamos más de 10 años en la industria del transporte químico y puedo decir que los tanques ISO de Tank Global Solutions son de los mejores que hemos utilizado. El servicio postventa es impecable.",
    author: "Roberto Kim",
    role: "Director General | TransQuim",
    avatarSrc:
      "https://images.unsplash.com/photo-1474176857210-7287d38d27c6?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D8&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Foto de Roberto Kim",
  },
];

const pageTitle = `Productos | ${SITE.title}`;
const metaDescription =
  "Explore nuestra gama de tanques ISO diseñados para profesionales de la industria. Soluciones confiables para transporte de líquidos, gases y productos criogénicos.";
const ogTitle = `Productos | ${SITE.title}`;
---

<MainLayout
  title={pageTitle}
  lang="es"
  customDescription={metaDescription}
  customOgTitle={ogTitle}
  structuredData={{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "@id": "https://tankglobalsolution.com/es/products",
    url: "https://tankglobalsolution.com/es/products",
    name: `Productos | ${SITE.title}`,
    description: metaDescription,
    isPartOf: {
      "@type": "WebSite",
      url: "https://tankglobalsolution.com/es",
      name: SITE.title,
      description: SITE.description,
    },
    inLanguage: "es",
  }}
>
  <div
    class="mx-auto max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 2xl:max-w-full"
  >
    <div class="mb-4 flex items-center justify-between gap-8 sm:mb-8 md:mb-12">
      <div class="flex items-center gap-12">
        <h1
          class="text-2xl font-bold tracking-tight text-balance text-neutral-800 md:text-4xl md:leading-tight dark:text-neutral-200"
        >
          {title}
        </h1>
        {
          subTitle && (
            <p class="hidden max-w-(--breakpoint-sm) text-pretty text-neutral-600 md:block dark:text-neutral-400">
              {subTitle}
            </p>
          )
        }
      </div>
      <PrimaryCTA
        title="Testimonios de clientes"
        url="#testimonials"
        noArrow={true}
      />
    </div>
    {/* Displaying products in alternating styles. Alternative product gets different card styling. */}
    {/* Maps through all product entries and displays them with either CardSmall or CardWide based on their position. */}
    <section class="grid grid-cols-1 gap-4 sm:grid-cols-3 md:gap-6 xl:gap-8">
      {
        product.map((product, index) => {
          const position = index % 4;
          if (position === 0 || position === 3) {
            return <CardSmall product={product} productLocale="es" />;
          } else {
            return <CardWide product={product} productLocale="es" />;
          }
        })
      }
    </section>
  </div>
  {/* Features statistics section */}
  <FeaturesStatsAlt
    title="¿Por qué elegir Tank Global Solutions?"
    subTitle="Transforme sus necesidades de transporte en soluciones tangibles con nuestros tanques ISO. Ya sea que necesite transportar líquidos, gases o productos criogénicos, nuestros equipos están diseñados para ayudarle a operar con confianza."
    benefits={[
      "Tanques robustos y confiables para un rendimiento duradero.",
      "Soluciones innovadoras adaptadas a las necesidades modernas de la industria.",
      "Soporte al cliente dedicado al éxito de su proyecto.",
    ]}
  />
  {/* Testimonials section */}
  <TestimonialsSectionAlt
    title="Lo que dicen nuestros clientes"
    testimonials={testimonials}
  />
</MainLayout>
