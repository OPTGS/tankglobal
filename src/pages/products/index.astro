---
// Importing necessary components
import MainLayout from "@/layouts/MainLayout.astro";
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import CardSmall from "@components/ui/cards/CardSmall.astro";
import CardWide from "@components/ui/cards/CardWide.astro";
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import TestimonialsSectionAlt from "@components/sections/testimonials/TestimonialsSectionAlt.astro";

// Importing necessary functions from Astro
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { SITE } from "@data";

// Fetching all the product related content and sorting it by main.id
const product: CollectionEntry<"products">[] = (
  await getCollection("products", ({ id }) => {
    return id.startsWith("en/");
  })
).sort(
  (a: CollectionEntry<"products">, b: CollectionEntry<"products">) =>
    a.data.main.id - b.data.main.id
);

// Define variables for page content
const title: string = "Products";
const subTitle: string =
  "Explore our range of ISO tanks designed for industry professionals. Each of our products is precision-engineered and built to last, ensuring reliable solutions for every need.";

// Testimonial data that will be rendered in the component
const testimonials = [
  // First testimonial data
  {
    content:
      " \"Since partnering with Tank Global Solutions, the efficiency of our logistics operations has improved significantly. The quality of the ISO tanks and technical support are unmatched.\" ",
    author: "Jason Clark",
    role: "Operations Director | LogiChem",
    avatarSrc:
      "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Photo of Jason Clark",
  },
  // Second testimonial data
  {
    content:
      " \"As a plant manager, I always look for high-quality equipment that ensures the safety of our operations. Tank Global's cryogenic tanks have been an excellent investment for our company.\" ",
    author: "Maria Gonzalez",
    role: "Plant Manager | CryoTech Industries",
    avatarSrc:
      "https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1376&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D8&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Photo of Maria Gonzalez",
  },
  // Third testimonial data
  {
    content:
      " \"We've been in the chemical transport industry for over 10 years, and I can sincerely say that Tank Global Solutions' ISO tanks are some of the best we've used. The after-sales service is impeccable.\" ",
    author: "Richard Kim",
    role: "CEO | TransQuim",
    avatarSrc:
      "https://images.unsplash.com/photo-1474176857210-7287d38d27c6?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D8&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Photo of Richard Kim",
  },
];

const pageTitle: string = `Products | ${SITE.title}`;
const metaDescription =
  "Explore our range of ISO tanks designed for industry professionals. Reliable solutions for liquid, gas, and cryogenic product transport.";
const ogTitle = `Products | ${SITE.title}`;
---

<MainLayout
  title={pageTitle}
  customDescription={metaDescription}
  customOgTitle={ogTitle}
  structuredData={{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "@id": "https://tankglobalsolution.com/products",
    url: "https://tankglobalsolution.com/products",
    name: `Products | ${SITE.title}`,
    description: metaDescription,
    isPartOf: {
      "@type": "WebSite",
      url: "https://tankglobalsolution.com",
      name: SITE.title,
      description: SITE.description,
    },
    inLanguage: "en-US",
  }}
>
  <div
    class="mx-auto max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 2xl:max-w-full"
  >
    <div class="mb-4 flex items-center justify-between gap-8 sm:mb-8 md:mb-12">
      <div class="flex items-center gap-12">
        <h1
          class="text-2xl font-bold tracking-tight text-balance text-neutral-800 md:text-4xl md:leading-tight dark:text-neutral-200"
        >
          {title}
        </h1>
        {
          subTitle && (
            <p class="hidden max-w-(--breakpoint-sm) text-pretty text-neutral-600 md:block dark:text-neutral-400">
              {subTitle}
            </p>
          )
        }
      </div>
      <PrimaryCTA title="Customer Stories" url="#testimonials" noArrow={true} />
    </div>
    {/* Displaying products in alternating styles. Alternative product gets different card styling.
    Maps through all product entries and displays them with either CardSmall or CardWide based on their position. */}
    <section class="grid grid-cols-1 gap-4 sm:grid-cols-3 md:gap-6 xl:gap-8">
      {
        product.map((product, index) => {
          const position = index % 4;
          if (position === 0 || position === 3) {
            return <CardSmall product={product} />;
          } else {
            return <CardWide product={product} />;
          }
        })
      }
    </section>
  </div>
  {/* Features statistics section */}
  <FeaturesStatsAlt
    title="Why Choose Tank Global Solutions?"
    subTitle="Transform your transport needs into tangible solutions with our ISO tanks. Whether you need to transport liquids, gases, or cryogenic products, our equipment is engineered to help you operate with confidence."
    benefits={[
      "Robust and reliable tanks for long-lasting performance.",
      "Innovative solutions tailored to modern industry needs.",
      "Customer support dedicated to your project's success.",
    ]}
  />
  {/* Testimonials section */}
  <TestimonialsSectionAlt
    title="What Our Customers Say"
    testimonials={testimonials}
  />
</MainLayout>
